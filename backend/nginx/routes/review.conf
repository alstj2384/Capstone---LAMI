# /api/review/숫자만 포함된 요청 처리 (GET은 제외, 나머지는 JWT 검사)
location ~ ^/api/review/\d+$ {
    access_by_lua_block {
        local method = ngx.req.get_method()
        if method ~= "GET" then
            local jwt_auth = require("jwt_auth")
            jwt_auth.check()
        end
    }
    proxy_pass http://review-service;
}

# 정확히 /api/review 경로 처리
location = /api/review {
    access_by_lua_block {
        local jwt_auth = require("jwt_auth")
        jwt_auth.check()
    }
    proxy_pass http://review-service;
}

# /api/review/ 하위 경로 전부 처리
location /api/review/ {
    access_by_lua_block {
        local jwt_auth = require("jwt_auth")
        jwt_auth.check()
    }
    proxy_pass http://review-service;
}